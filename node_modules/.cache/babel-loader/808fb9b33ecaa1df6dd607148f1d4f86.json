{"remainingRequest":"/Users/c5281434/Documents/Project/yshopmall_qd-master/node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!/Users/c5281434/Documents/Project/yshopmall_qd-master/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/c5281434/Documents/Project/yshopmall_qd-master/node_modules/_vue-loader@15.9.2@vue-loader/lib/index.js??vue-loader-options!/Users/c5281434/Documents/Project/yshopmall_qd-master/src/components/material/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/c5281434/Documents/Project/yshopmall_qd-master/src/components/material/index.vue","mtime":1590767910000},{"path":"/Users/c5281434/Documents/Project/yshopmall_qd-master/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/c5281434/Documents/Project/yshopmall_qd-master/node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/c5281434/Documents/Project/yshopmall_qd-master/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/c5281434/Documents/Project/yshopmall_qd-master/node_modules/_vue-loader@15.9.2@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/c5281434/Documents/Project/yshopmall_qd-master/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.string.link\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\nvar _defineProperty2 = _interopRequireDefault(require(\"/Users/c5281434/Documents/Project/yshopmall_qd-master/node_modules/@babel/runtime/helpers/defineProperty\"));\n\nrequire(\"core-js/modules/es6.number.constructor\");\n\nvar _materialgroup = require(\"@/api/tools/materialgroup\");\n\nvar _material = require(\"@/api/tools/material\");\n\nvar _auth = require(\"@/utils/auth\");\n\nvar _vuex = require(\"vuex\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar _default2 = {\n  name: 'MaterialList',\n  props: {\n    // 素材数据\n    value: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    // 素材类型\n    type: {\n      type: String\n    },\n    // 素材限制数量，默认5个\n    num: {\n      type: Number,\n      default: function _default() {\n        return 5;\n      }\n    },\n    // 宽度\n    width: {\n      type: Number,\n      default: function _default() {\n        return 150;\n      }\n    },\n    // 宽度\n    height: {\n      type: Number,\n      default: function _default() {\n        return 150;\n      }\n    }\n  },\n  data: function data() {\n    return {\n      headers: {\n        Authorization: (0, _auth.getToken)()\n      },\n      dialogVisible: false,\n      url: '',\n      listDialogVisible: false,\n      materialgroupList: [],\n      materialgroupObjId: '',\n      materialgroupObj: {},\n      materialgroupLoading: false,\n      tableData: [],\n      resultNumber: 0,\n      page: {\n        total: 0,\n        // 总页数\n        currentPage: 1,\n        // 当前页数\n        pageSize: 12,\n        // 每页显示多少条\n        ascs: [],\n        // 升序字段\n        descs: 'create_time' // 降序字段\n\n      },\n      tableLoading: false,\n      groupId: null,\n      urls: []\n    };\n  },\n  computed: _objectSpread({}, (0, _vuex.mapGetters)(['uploadApi'])),\n  methods: {\n    moveMaterial: function moveMaterial(index, type) {\n      if (type == 'up') {\n        var tempOption = this.value[index - 1];\n        this.$set(this.value, index - 1, this.value[index]);\n        this.$set(this.value, index, tempOption);\n      }\n\n      if (type == 'down') {\n        var _tempOption = this.value[index + 1];\n        this.$set(this.value, index + 1, this.value[index]);\n        this.$set(this.value, index, _tempOption);\n      }\n    },\n    zoomMaterial: function zoomMaterial(index) {\n      this.dialogVisible = true;\n      this.url = this.value[index];\n    },\n    deleteMaterial: function deleteMaterial(index) {\n      var that = this;\n      this.$confirm('是否确认删除？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        that.value.splice(index, 1);\n        that.urls = [];\n      });\n    },\n    toSeleteMaterial: function toSeleteMaterial() {\n      this.listDialogVisible = true;\n\n      if (this.tableData.length <= 0) {\n        this.materialgroupPage();\n      }\n    },\n    materialgroupPage: function materialgroupPage() {\n      var _this = this;\n\n      this.materialgroupLoading = true;\n      (0, _materialgroup.getPage)({\n        total: 0,\n        // 总页数\n        currentPage: 1,\n        // 当前页数\n        pageSize: 100,\n        // 每页显示多少条\n        ascs: [],\n        // 升序字段\n        descs: 'create_time' // 降序字段\n\n      }).then(function (response) {\n        _this.materialgroupLoading = false;\n        var materialgroupList = response.content;\n        materialgroupList.unshift({\n          id: '-1',\n          name: '全部分组'\n        });\n        _this.materialgroupList = materialgroupList;\n\n        _this.tabClick({\n          index: 0\n        });\n      });\n    },\n    materialgroupDelete: function materialgroupDelete(materialgroupObj) {\n      var that = this;\n      this.$confirm('是否确认删除该分组？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        (0, _materialgroup.delObj)(materialgroupObj.id).then(function () {\n          that.$delete(that.materialgroupList, materialgroupObj.index);\n        });\n      });\n    },\n    materialgroupEdit: function materialgroupEdit(materialgroupObj) {\n      var that = this;\n      this.$prompt('请输入分组名', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        inputValue: materialgroupObj.name\n      }).then(function (_ref) {\n        var value = _ref.value;\n        (0, _materialgroup.putObj)({\n          id: materialgroupObj.id,\n          name: value\n        }).then(function () {\n          materialgroupObj.name = value;\n          that.$set(that.materialgroupList, materialgroupObj.index, materialgroupObj);\n        });\n      }).catch(function () {});\n    },\n    materialgroupAdd: function materialgroupAdd() {\n      var that = this;\n      this.$prompt('请输入分组名', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消'\n      }).then(function (_ref2) {\n        var value = _ref2.value;\n        (0, _materialgroup.addObj)({\n          name: value\n        }).then(function () {\n          that.materialgroupPage();\n        });\n      }).catch(function () {});\n    },\n    tabClick: function tabClick(tab, event) {\n      this.urls = [];\n      var index = Number(tab.index);\n      var materialgroupObj = this.materialgroupList[index];\n      materialgroupObj.index = index;\n      this.materialgroupObj = materialgroupObj;\n      this.materialgroupObjId = materialgroupObj.id;\n      this.page.currentPage = 1;\n      this.page.total = 0;\n\n      if (materialgroupObj.id != '-1') {\n        this.groupId = materialgroupObj.id;\n      } else {\n        this.groupId = null;\n      }\n\n      this.getPage(this.page);\n    },\n    getPage: function getPage(page, params) {\n      var _this2 = this;\n\n      this.tableLoading = true;\n      (0, _material.getPage)(Object.assign({\n        page: page.currentPage - 1,\n        size: page.pageSize,\n        descs: this.page.descs,\n        ascs: this.page.ascs,\n        sort: 'create_time,desc'\n      }, {\n        groupId: this.groupId\n      })).then(function (response) {\n        var tableData = response.content;\n        _this2.page.total = response.totalElements;\n        _this2.page.currentPage = page.currentPage;\n        _this2.page.pageSize = page.pageSize;\n        _this2.tableData = tableData;\n        _this2.tableLoading = false;\n      }).catch(function () {\n        _this2.tableLoading = false;\n      });\n    },\n    sizeChange: function sizeChange(val) {\n      console.log(val);\n      this.page.currentPage = 1;\n      this.page.pageSize = val;\n      this.getPage(this.page);\n    },\n    pageChange: function pageChange(val) {\n      console.log(val);\n      this.page.currentPage = val; // this.page.pageSize = val\n\n      this.getPage(this.page);\n    },\n    materialRename: function materialRename(item) {\n      var that = this;\n      this.$prompt('请输入素材名', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        inputValue: item.name\n      }).then(function (_ref3) {\n        var value = _ref3.value;\n        (0, _material.putObj)({\n          id: item.id,\n          name: value\n        }).then(function () {\n          that.getPage(that.page);\n        });\n      }).catch(function () {});\n    },\n    materialUrl: function materialUrl(item) {\n      var that = this;\n      this.$prompt('素材链接', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        inputValue: item.url\n      }).then(function (_ref4) {\n        var value = _ref4.value;\n      }).catch(function () {});\n    },\n    materialDel: function materialDel(item) {\n      var that = this;\n      this.$confirm('是否确认删除该素材？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        (0, _material.delObj)(item.id).then(function () {\n          that.getPage(that.page);\n        });\n      });\n    },\n    handleCommand: function handleCommand(command) {\n      var that = this;\n      var s = command.split('-');\n      (0, _material.putObj)({\n        id: s[0],\n        groupId: s[1]\n      }).then(function () {\n        that.getPage(that.page);\n      });\n    },\n    handleProgress: function handleProgress(event, file, fileList) {\n      console.log(event); // let uploadProgress = file.percentage.toFixed(0)\n      // this.uploadProgress = uploadProgress\n    },\n    handleSuccess: function handleSuccess(response, file, fileList) {\n      var _this3 = this;\n\n      var that = this;\n      this.uploadProgress = 0;\n      (0, _material.addObj)({\n        type: '1',\n        groupId: this.groupId != '-1' ? this.groupId : null,\n        name: file.name,\n        url: response.link\n      }).then(function () {\n        _this3.resultNumber++;\n\n        if (fileList.length === _this3.resultNumber) {\n          that.getPage(that.page);\n          _this3.resultNumber = 0;\n        }\n      });\n    },\n    beforeUpload: function beforeUpload(file) {\n      var isPic = file.type === 'image/jpeg' || file.type === 'image/png' || file.type === 'image/gif' || file.type === 'image/jpg';\n      var isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isPic) {\n        this.$message.error('上传图片只能是 JPG、JPEG、PNG、GIF 格式!');\n        return false;\n      }\n\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n\n      return isPic && isLt2M;\n    },\n    sureUrls: function sureUrls() {\n      var _this4 = this;\n\n      this.urls.forEach(function (item) {\n        _this4.$set(_this4.value, _this4.value.length, item);\n      });\n      this.listDialogVisible = false;\n    }\n  }\n};\nexports.default = _default2;",null]}